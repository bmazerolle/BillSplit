{"version":3,"file":"groupJoin.js","sourceRoot":"","sources":["../../src/scripts/groupJoin.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * Summary: Formatting option for the options\n * @param group\n */\nfunction format(group: any): any {\n    const $option = $(\"<tr><td><b></b></td></tr><tr><td><p></p></td></tr>\");\n    $option.find(\"b\").text(group.name);\n    $option.find(\"p\").text(group.id);\n    return $option;\n}\n\n/**\n * Summary: Adds a member to a payer field of a bill\n * @param members\n * @param group\n * @param user\n */\nfunction addToPayers(members: string[], group?: string, user?: string) {\n    for (const member of members) {\n        $.ajax({\n            data: \"group=\" + group + \"&member=\" + member + \"&payer=\" + user,\n            error: (xhr, ajaxOptions, thrownError) => {\n                alert(xhr.status);\n                alert(thrownError);\n            },\n            type: \"POST\",\n            url: \"/bill/payer/add\",\n        });\n    }\n}\n\n/**\n * Summary: Creates a new bill and passes it to be added to a group\n * @param members\n * @param group\n * @param user\n */\nfunction createBill(members: string[], group?: string, user?: string) {\n    $.ajax({\n        data: \"billPayee=\" + user + \"&\" + $.param({billPayer: members}) + \"&billGroup=\" + group,\n        success: (result) => {\n            addBillsToGroup(result, group);\n        },\n        type: \"POST\",\n        url: \"/bill/create\",\n    });\n}\n\n/**\n * Summary: Adds a member to a group\n */\nfunction groupMemberAdd() {\n    const memberData = $(\"#member-add\").serialize();\n    $.ajax({\n        data: memberData,\n        success: (result) => {\n            addGroupToUser($(\"#group-id\").val());\n        },\n        type: \"POST\",\n        url: \"/group/member/add\",\n    });\n}\n\n/**\n * Summary: Adds functionality for the submit button\n */\nfunction addSubmit() {\n    $(\"#member-join-submit\").on(\"click\", () => {\n        $.ajax({\n            data: \"group=\" + $(\"#group-id\").val(),\n            success: (result) => {\n                createBill(result.members, \"\" + $(\"#group-id\").val(),  \"\" + $(\"#group-members\").val());\n                addToPayers(result.members, \"\" + $(\"#group-id\").val(),  \"\" + $(\"#group-members\").val());\n                groupMemberAdd();\n            },\n            type: \"GET\",\n            url: \"/group/members\",\n        });\n    });\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n    // @ts-ignore\n    $(\"#group-id\").select2({\n        ajax: {\n            data: (params: any): any => {\n                return {\n                    q: params.term,\n                };\n            },\n            dataType: \"json\",\n            processResults: (groups: any): any => {\n                return {\n                    results: $.map(groups, (group: any): any => {\n                        return {\n                            id: group._id,\n                            members: group.Members,\n                            name: group.Name,\n                            text: group.Name,\n                        };\n                    }),\n                };\n            },\n            url: \"/groups/query\",\n        },\n        templateResult: format,\n\n    });\n\n    addSubmit();\n});\n"]}