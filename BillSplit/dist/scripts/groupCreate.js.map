{"version":3,"file":"groupCreate.js","sourceRoot":"","sources":["../../src/scripts/groupCreate.ts"],"names":[],"mappings":"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","sourcesContent":["document.addEventListener(\"DOMContentLoaded\", () => {\n    // @ts-ignore\n    $(\"#group-members\").select2();\n    $.get(\"/users\", (users: any) => {\n        for (const user of users) {\n            const option = document.createElement(\"option\");\n            option.value = user._id;\n            option.text = user.Name;\n            const select = document.getElementById(\"group-members\");\n            if (select) {\n                select.appendChild(option);\n            }\n        }\n    });\n    // Add group function\n    $(() => {\n        $(\"#group-add-submit\").on(\"click\", () => {\n            const groupData = $(\"#group-add\").serialize();\n            $.ajax({\n                data: groupData,\n                error: (xhr, ajaxOptions, thrownError) => {\n                    alert(xhr.status);\n                    alert(thrownError);\n                },\n                success: (result) => {\n                    addGroupToUser(result.groupId);\n                    createBills(result.groupId);\n                },\n                type: \"POST\",\n                url: \"/group/add\",\n            });\n        });\n    });\n});\n\n// Adds a group to a user\nfunction addGroupToUser(groupId: any) {\n    const members = {\n        group: groupId,\n        users: $(\"#group-members\").val(),\n    };\n    const membersData = $.param(members);\n    $.ajax({\n        data: membersData,\n        error: (xhr, ajaxOptions, thrownError) => {\n            alert(xhr.status);\n            alert(thrownError);\n        },\n        success: (result) => {\n            $(\"#message\").html(result.message);\n        },\n        type: \"POST\",\n        url: \"/user/group/addGroup\",\n    });\n}\n\n// Creates the bills for all group members upon group creation\nfunction createBills(groupId: string) {\n    const groupMembers = $(\"#group-members\").val();\n    const groupMemberStringArray = groupMembers as string[];\n    for (let i = 0; i < groupMemberStringArray.length; i++) {\n        const payersBeforePayee = groupMemberStringArray.slice(0, i);\n        const payersAfterPayee = (groupMemberStringArray.slice(i + 1, groupMemberStringArray.length));\n        const payers = payersBeforePayee.concat(payersAfterPayee);\n        const payee = groupMemberStringArray[i];\n        const bill = {\n            billGroup: groupId,\n            billPayee: payee,\n            billPayer: payers,\n        };\n        const billData = $.param(bill);\n        $.ajax({\n            data: billData,\n            error: (xhr, ajaxOptions, thrownError) => {\n                alert(xhr.status);\n                alert(thrownError);\n            },\n            success: (result) => {\n                addBillsToGroup(result, groupId);\n            },\n            type: \"POST\",\n            url: \"/bill/create\",\n        });\n    }\n}\n\n// Adds the created bills to the group they were created for\nfunction addBillsToGroup(insertedBills: any, groupId: any) {\n    const bill = {\n        bills: insertedBills,\n        group: groupId,\n    };\n    const billData = $.param(bill);\n    $.ajax({\n        data: billData,\n        error: (xhr, ajaxOptions, thrownError) => {\n            alert(xhr.status);\n            alert(thrownError);\n        },\n        success: (result) => {\n            $(\"#message\").html(\"Great Success\");\n        },\n        type: \"POST\",\n        url: \"/group/bill/add\",\n    });\n}\n"]}